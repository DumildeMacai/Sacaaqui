{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 15, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/firebase/adminInit.ts"],"sourcesContent":["'use server';\n\nimport * as admin from 'firebase-admin';\n\nlet db: admin.firestore.Firestore | null = null;\n\nfunction initializeAdmin() {\n  // Evita reinicializações\n  if (admin.apps.length > 0) {\n    if (!db) {\n      db = admin.firestore();\n    }\n    return;\n  }\n\n  try {\n    const serviceAccount = {\n      projectId: process.env.FIREBASE_PROJECT_ID,\n      // A chave privada precisa que os `\\n` literais sejam substituídos por novas linhas reais.\n      privateKey: (process.env.FIREBASE_ADMIN_PRIVATE_KEY || '').replace(/\\\\n/g, '\\n'),\n      clientEmail: process.env.FIREBASE_CLIENT_EMAIL,\n    };\n\n    // Validação explícita das credenciais\n    if (!serviceAccount.projectId || !serviceAccount.privateKey || !serviceAccount.clientEmail) {\n       console.error(\"As credenciais de serviço do Firebase Admin estão em falta ou incompletas. Verifique as suas variáveis de ambiente (.env.local).\");\n       return; // Sai se as credenciais estiverem incompletas\n    }\n    \n    admin.initializeApp({\n      credential: admin.credential.cert(serviceAccount),\n    });\n    \n    db = admin.firestore();\n    console.log(\"Firebase Admin SDK inicializado com sucesso.\");\n\n  } catch (error: any) {\n    console.error(\"Erro CRÍTICO ao inicializar o Firebase Admin SDK:\", error.message);\n  }\n}\n\n// Inicializa no momento em que o módulo é carregado\ninitializeAdmin();\n\nexport async function getAdminDb() {\n  if (!db) {\n    // A inicialização no nível superior falhou, não há como recuperar aqui.\n    throw new Error(\"O Firestore Admin não está disponível. A inicialização do Admin SDK pode ter falhado. Verifique os logs do servidor para erros críticos.\");\n  }\n  return db;\n}\n"],"names":[],"mappings":";;;;;AAEA;;;;;AAEA,IAAI,KAAuC;AAE3C,SAAS;IACP,yBAAyB;IACzB,IAAI,2HAAA,CAAA,OAAU,CAAC,MAAM,GAAG,GAAG;QACzB,IAAI,CAAC,IAAI;YACP,KAAK,CAAA,GAAA,2HAAA,CAAA,YAAe,AAAD;QACrB;QACA;IACF;IAEA,IAAI;QACF,MAAM,iBAAiB;YACrB,WAAW,QAAQ,GAAG,CAAC,mBAAmB;YAC1C,0FAA0F;YAC1F,YAAY,CAAC,QAAQ,GAAG,CAAC,0BAA0B,IAAI,EAAE,EAAE,OAAO,CAAC,QAAQ;YAC3E,aAAa,QAAQ,GAAG,CAAC,qBAAqB;QAChD;QAEA,sCAAsC;QACtC,IAAI,CAAC,eAAe,SAAS,IAAI,CAAC,eAAe,UAAU,IAAI,CAAC,eAAe,WAAW,EAAE;YACzF,QAAQ,KAAK,CAAC;YACd,QAAQ,8CAA8C;QACzD;QAEA,CAAA,GAAA,2HAAA,CAAA,gBAAmB,AAAD,EAAE;YAClB,YAAY,2HAAA,CAAA,aAAgB,CAAC,IAAI,CAAC;QACpC;QAEA,KAAK,CAAA,GAAA,2HAAA,CAAA,YAAe,AAAD;QACnB,QAAQ,GAAG,CAAC;IAEd,EAAE,OAAO,OAAY;QACnB,QAAQ,KAAK,CAAC,qDAAqD,MAAM,OAAO;IAClF;AACF;AAEA,oDAAoD;AACpD;AAEO,eAAe;IACpB,IAAI,CAAC,IAAI;QACP,wEAAwE;QACxE,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT;;;IANsB;;AAAA,+OAAA","debugId":null}},
    {"offset": {"line": 75, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/lib/data.ts"],"sourcesContent":["'use server'\n\nimport { getAdminDb } from '@/firebase/adminInit';\nimport type { Atm } from '@/types';\n\nexport async function getAtms(): Promise<Atm[]> {\n  const adminDb = await getAdminDb();\n\n  try {\n    const atmsSnapshot = await adminDb.collection('atms').get();\n    if (atmsSnapshot.empty) {\n      console.log(\"Nenhum ATM encontrado no Firestore.\");\n      return [];\n    }\n\n    const atms = atmsSnapshot.docs.map(doc => {\n      const data = doc.data();\n      return {\n        id: doc.id,\n        ...data,\n        // Garante que os Timestamps sejam convertidos para strings ISO\n        lastUpdate: data.lastUpdate?.toDate?.().toISOString() || new Date().toISOString(),\n        reports: data.reports?.map((report: any) => ({\n          ...report,\n          timestamp: report.timestamp?.toDate?.().toISOString() || report.timestamp || new Date().toISOString(),\n        })) || [],\n      } as Atm;\n    });\n    return atms;\n  } catch (error) {\n    console.error(\"Erro ao buscar ATMs no Firestore:\", error);\n    return [];\n  }\n}\n\nexport async function getAtmById(id: string): Promise<Atm | null> {\n    const adminDb = await getAdminDb();\n  \n    try {\n      const atmDoc = await adminDb.collection('atms').doc(id).get();\n  \n      if (!atmDoc.exists) {\n        console.log(`ATM com id ${id} não encontrado.`);\n        return null;\n      }\n  \n      const data = atmDoc.data()!;\n      \n      return {\n        id: atmDoc.id,\n        ...data,\n         // Garante que os Timestamps sejam convertidos para strings ISO\n         lastUpdate: data.lastUpdate?.toDate?.().toISOString() || new Date().toISOString(),\n         reports: data.reports?.map((report: any) => ({\n           ...report,\n           timestamp: report.timestamp?.toDate?.().toISOString() || report.timestamp || new Date().toISOString(),\n         })) || [],\n      } as Atm;\n  \n    } catch (error) {\n      console.error(`Erro ao buscar ATM com id ${id}:`, error);\n      return null;\n    }\n  }\n"],"names":[],"mappings":";;;;;;AAEA;;;;;AAGO,eAAe;IACpB,MAAM,UAAU,MAAM,CAAA,GAAA,4HAAA,CAAA,aAAU,AAAD;IAE/B,IAAI;QACF,MAAM,eAAe,MAAM,QAAQ,UAAU,CAAC,QAAQ,GAAG;QACzD,IAAI,aAAa,KAAK,EAAE;YACtB,QAAQ,GAAG,CAAC;YACZ,OAAO,EAAE;QACX;QAEA,MAAM,OAAO,aAAa,IAAI,CAAC,GAAG,CAAC,CAAA;YACjC,MAAM,OAAO,IAAI,IAAI;YACrB,OAAO;gBACL,IAAI,IAAI,EAAE;gBACV,GAAG,IAAI;gBACP,+DAA+D;gBAC/D,YAAY,KAAK,UAAU,EAAE,WAAW,iBAAiB,IAAI,OAAO,WAAW;gBAC/E,SAAS,KAAK,OAAO,EAAE,IAAI,CAAC,SAAgB,CAAC;wBAC3C,GAAG,MAAM;wBACT,WAAW,OAAO,SAAS,EAAE,WAAW,iBAAiB,OAAO,SAAS,IAAI,IAAI,OAAO,WAAW;oBACrG,CAAC,MAAM,EAAE;YACX;QACF;QACA,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,qCAAqC;QACnD,OAAO,EAAE;IACX;AACF;AAEO,eAAe,WAAW,EAAU;IACvC,MAAM,UAAU,MAAM,CAAA,GAAA,4HAAA,CAAA,aAAU,AAAD;IAE/B,IAAI;QACF,MAAM,SAAS,MAAM,QAAQ,UAAU,CAAC,QAAQ,GAAG,CAAC,IAAI,GAAG;QAE3D,IAAI,CAAC,OAAO,MAAM,EAAE;YAClB,QAAQ,GAAG,CAAC,CAAC,WAAW,EAAE,GAAG,gBAAgB,CAAC;YAC9C,OAAO;QACT;QAEA,MAAM,OAAO,OAAO,IAAI;QAExB,OAAO;YACL,IAAI,OAAO,EAAE;YACb,GAAG,IAAI;YACN,+DAA+D;YAC/D,YAAY,KAAK,UAAU,EAAE,WAAW,iBAAiB,IAAI,OAAO,WAAW;YAC/E,SAAS,KAAK,OAAO,EAAE,IAAI,CAAC,SAAgB,CAAC;oBAC3C,GAAG,MAAM;oBACT,WAAW,OAAO,SAAS,EAAE,WAAW,iBAAiB,OAAO,SAAS,IAAI,IAAI,OAAO,WAAW;gBACrG,CAAC,MAAM,EAAE;QACZ;IAEF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,CAAC,0BAA0B,EAAE,GAAG,CAAC,CAAC,EAAE;QAClD,OAAO;IACT;AACF;;;IA1DoB;IA8BA;;AA9BA,+OAAA;AA8BA,+OAAA","debugId":null}},
    {"offset": {"line": 150, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/.next-internal/server/app/dashboard/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {getAtms as '002c531ac2a548d2243e12d2377a999227baa47290'} from 'ACTIONS_MODULE0'\nexport {getAtmById as '404d695c714c8bdc108eb0254a6f4bdb6d18a8f109'} from 'ACTIONS_MODULE0'\nexport {getAdminDb as '00f726833eb87708caf956d71bb65a18a54ea1101d'} from 'ACTIONS_MODULE1'\n"],"names":[],"mappings":";AAAA;AAEA","debugId":null}},
    {"offset": {"line": 217, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/atm-list.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const AtmList = registerClientReference(\n    function() { throw new Error(\"Attempted to call AtmList() from the server but AtmList is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/atm-list.tsx <module evaluation>\",\n    \"AtmList\",\n);\n"],"names":[],"mappings":";;;AAAA;;AACO,MAAM,UAAU,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACzC;IAAa,MAAM,IAAI,MAAM;AAA8N,GAC3P,6DACA","debugId":null}},
    {"offset": {"line": 231, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/atm-list.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const AtmList = registerClientReference(\n    function() { throw new Error(\"Attempted to call AtmList() from the server but AtmList is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/atm-list.tsx\",\n    \"AtmList\",\n);\n"],"names":[],"mappings":";;;AAAA;;AACO,MAAM,UAAU,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACzC;IAAa,MAAM,IAAI,MAAM;AAA8N,GAC3P,yCACA","debugId":null}},
    {"offset": {"line": 245, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 255, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/logout-button.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const LogoutButton = registerClientReference(\n    function() { throw new Error(\"Attempted to call LogoutButton() from the server but LogoutButton is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/logout-button.tsx <module evaluation>\",\n    \"LogoutButton\",\n);\n"],"names":[],"mappings":";;;AAAA;;AACO,MAAM,eAAe,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EAC9C;IAAa,MAAM,IAAI,MAAM;AAAwO,GACrQ,kEACA","debugId":null}},
    {"offset": {"line": 269, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/components/logout-button.tsx/proxy.mjs"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport const LogoutButton = registerClientReference(\n    function() { throw new Error(\"Attempted to call LogoutButton() from the server but LogoutButton is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/components/logout-button.tsx\",\n    \"LogoutButton\",\n);\n"],"names":[],"mappings":";;;AAAA;;AACO,MAAM,eAAe,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EAC9C;IAAa,MAAM,IAAI,MAAM;AAAwO,GACrQ,8CACA","debugId":null}},
    {"offset": {"line": 283, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 293, "column": 0}, "map": {"version":3,"sources":["file:///home/user/studio/src/app/dashboard/page.tsx"],"sourcesContent":["import type { Atm } from '@/types'; \nimport { AtmList } from '@/components/atm-list';\nimport { LogoutButton } from '@/components/logout-button';\nimport { Suspense } from 'react';\nimport { getAtms } from '@/lib/data'; // Importa a função para buscar dados reais\n\nexport default async function DashboardPage() { \n  // Usa a função para buscar dados do Firestore\n  const atms = await getAtms();\n\n return (\n    <div className=\"min-h-screen p-8\"> \n      <div className=\"flex justify-between items-center mb-8\"> \n        <div className=\"mb-8\"> \n          <h1 className=\"text-3xl font-bold tracking-tight font-headline\">ATMs Próximos</h1>\n          <p className=\"text-muted-foreground\">Veja o status dos caixas e ajude a comunidade.</p> \n        </div>\n        <LogoutButton /> \n      </div>\n      <Suspense fallback={<div>Carregando...</div>}>\n        <AtmList initialAtms={atms} />\n      </Suspense>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;AACA;AACA;AACA;AACA,sMAAsC,2CAA2C;;;;;;AAElE,eAAe;IAC5B,8CAA8C;IAC9C,MAAM,OAAO,MAAM,CAAA,GAAA,kHAAA,CAAA,UAAO,AAAD;IAE1B,qBACG,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAG,WAAU;0CAAkD;;;;;;0CAChE,8OAAC;gCAAE,WAAU;0CAAwB;;;;;;;;;;;;kCAEvC,8OAAC,sIAAA,CAAA,eAAY;;;;;;;;;;;0BAEf,8OAAC,qMAAA,CAAA,WAAQ;gBAAC,wBAAU,8OAAC;8BAAI;;;;;;0BACvB,cAAA,8OAAC,iIAAA,CAAA,UAAO;oBAAC,aAAa;;;;;;;;;;;;;;;;;AAI9B","debugId":null}}]
}